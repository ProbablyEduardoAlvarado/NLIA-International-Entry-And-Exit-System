# ✈️ NLIA: International Entry and Exit System Documentation

[cite_start]**Author:** Eduardo Alvarado [cite: 1]  
[cite_start]**Date:** 10/31/2025 [cite: 2]  
[cite_start]**Course:** CST-204-001 [cite: 3]  
[cite_start]**Professor:** Prof. Elble [cite: 4]

[cite_start]This document focuses on the **database design (schema)**, **business rules**, and **primary use cases (SQL functions)** for the Traveler Admission and I-94 Tracking System[cite: 5, 6].

[cite_start]The system is designed to simulate the arrival and inspection of an **international passenger** at a U.S. airport of entry, capturing information from scanned passports, visas, or Permanent Resident Cards (ARC/LPR Card)[cite: 7, 8].

---

## 1. Database Schema (Entity-Relationship Diagram)

The following diagram illustrates the structure of the database, including all entities and their relationships:

[cite_start] [cite: 9]

### Table Definitions

| Table Name | Purpose | Primary Key (PK) | Key Fields/Relationships |
| :--- | :--- | :--- | :--- |
| **Country** | Stores a comprehensive list of countries used for validation of passport issuance and flight origins. | [cite_start]**CountryCode** (3-character ISO code) [cite: 10] | [cite_start]CountryName [cite: 10] |
| **Admission\_Class** | Defines all categories of admission (e.g., visa types, status) used in the U.S. immigration system. | [cite_start]**ClassCode** (e.g., 'B1', 'F1', 'PR') [cite: 10] | [cite_start]ClassDescription, IsPermanentResidentClass (Boolean) [cite: 10] |
| **Passport** | Stores biographic and issuance data for a traveler's passport document. | [cite_start]**Composite PK:** (PassportNumber, CountryCode) [cite: 10, 15] | [cite_start]GivenName, Surname, IssueDate, ExpDate [cite: 10] |
| **Person** | The central entity representing an individual traveler. | [cite_start]**PersonID** (Primary Key) [cite: 10] | ANumber (Alien Registration Number, if assigned). [cite_start]Links to Passport via a composite Foreign Key. [cite: 10] |
| **Flight** | Records a specific incoming flight arrival event. | [cite_start]**FlightID** (Primary Key) [cite: 10] | [cite_start]**Uniqueness Constraint:** (AirlineCode, FlightNumber, OriginAirportCode, FlightDate). [cite: 10, 16] |
| **I\_94** | The core record of inspection, similar to the electronic Form I-94. | [cite_start]**RecordID** (Primary Key) [cite: 10] | Foreign Keys to Person, Flight, and Admission\_Class. [cite_start]Records EntryDate, Admitted (Boolean), and NotAdmittedReason. [cite: 10] |
| **Person\_Admission\_Class** | A historical log and bridge table tracking every time a person is granted a specific class of admission. | [cite_start]**Composite PK:** (PersonID, ClassCode, I94RecordID) [cite: 10] | [cite_start]GrantDate (Entry Date of the I-94 record). [cite: 10] |

---

## 2. Business Rules and Status Logic

[cite_start]The system enforces several critical business rules through its data model and procedural logic[cite: 11, 12]:

### [cite_start]A. Unique Identification [cite: 15, 16]
* **Passport:** Uniquely identified by the combination of its **number** and **issuing country**.
* **Flight Arrival:** A specific arrival event is uniquely identified by the combination of the **airline code**, **flight number**, **origin airport code**, and the **date of arrival**.

### B. Status of Citizens and Permanent Residents
* **U.S. [cite_start]Citizens** use the admission class **'C'** for system identification[cite: 18].
* [cite_start]**Lawful Permanent Residents ('PR')** and U.S. Citizens (where `IsPermanentResidentClass` is **TRUE**) have an **indeterminate ExitDate**, which is set to **NULL** upon entry[cite: 22].
* [cite_start]**Immigrant Visa** entries are initially coded by their category (e.g., IR1, EB1) and require an **A-Number**; future entries will be coded as **'PR'**[cite: 19, 20, 21].

### C. Status of Non-Citizens/Aliens
* [cite_start]For **Non-Permanent Residents** (`IsPermanentResidentClass` is **FALSE**), the **ExitDate** represents their authorized date of departure, consistent with their **GrantDate** (Entry Date) and class of admission[cite: 24].
* [cite_start]Aliens **denied admission** (`Admitted` is **FALSE**) are assigned an **ANumber** and have a mandatory removal **ExitDate** scheduled shortly after denial[cite: 25].

---

## 3. Core Functions (SQL Use Cases)

The project utilizes three primary stored procedures/functions to manage data, defined in the `functions.sql` file.

### 3.1. [cite_start]The `Admit_New_Traveler` Function [cite: 26]

[cite_start]This function is the centerpiece of the system, streamlining the entire arrival inspection process into a single transaction[cite: 27].

**Process Flow:**
1.  [cite_start]**Passport Check:** Inserts the passport; skips if the unique PassportNumber/CountryCode combination already exists (`ON CONFLICT DO NOTHING`)[cite: 29, 30].
2.  **Person Check & Upsert:** Checks for the person record based on the passport. [cite_start]Creates a new `Person` record or updates an existing one (e.g., if a new ANumber is provided)[cite: 31, 32, 33].
3.  **Flight Check & Upsert:** Checks for the specific flight arrival event using the unique flight constraint. [cite_start]Creates a new `Flight` record if needed, or reuses the existing `FlightID`[cite: 34, 35, 36].
4.  [cite_start]**I-94 Record Creation:** Inserts a new **I\_94** record, linking the traveler (`PersonID`), the arrival event (`FlightID`), and the admission status[cite: 37].
5.  [cite_start]**Historical Log:** Inserts a record into the **Person\_Admission\_Class** table to log the specific class granted[cite: 38].

**Key Data Collected for the Function:**
[cite_start]The function gathers critical information from traveler documents presented at inspection[cite: 42]:

| Data Source | Fields Collected | [cite_start]Example Document  [cite: 43] |
| :--- | :--- | :--- |
| [cite_start]**Passport** [cite: 44] | [cite_start]GivenName, Surname, DOB, PassportNumber, CountryCode, PassportIssueDate, PassportExpDate [cite: 45, 46, 47, 48, 49, 50, 51] |
| [cite_start]**Boarding Pass** [cite: 59] | [cite_start]AirlineCode, FlightNumber, OriginAirport (IATA), ArrivalDate, FlightCountryCode (Implied) [cite: 60, 61, 62, 63] |  |
| **Admission Documents** | [cite_start]Admission\_Class\_Code, ANumber (e.g., USCIS# / Registration No.), ExitDate (Officer Input), NotAdmittedReason (Officer Input) [cite: 54, 57, 41] | [cite_start]  [cite: 52, 56] |

### 3.2. [cite_start]The `Lookup_I94_Record` Function [cite: 99]

[cite_start]This function allows an officer to retrieve an individual's full entry and exit history of **I-94 records**[cite: 100].

**Lookup Logic:**
[cite_start]The function is designed to verify identity and retrieve records using two methods[cite: 102]:
* [cite_start]**Highest Priority:** **A-Number Lookup** (for LPRs and denied aliens like John Childs)[cite: 103, 115].
* [cite_start]**Secondary Lookup:** **Passport Number & Country Code** (for Citizens and non-immigrants like Sarah Chen)[cite: 104, 118].

**Data Returned (Displayed to Officer):**
[cite_start]The I-94 record displays core information about the entry/attempted entry event[cite: 105]:
* [cite_start]I-94 RecordID, PersonID, FlightID, ClassCode (Admission\_Class) [cite: 106, 107, 108, 109]
* [cite_start]DateOfEntry, Admitted (TRUE/FALSE), ExitDate, NotAdmittedReason [cite: 110, 111, 112, 113]

[cite_start] [cite: 99]
[cite_start] [cite: 114]
[cite_start] [cite: 117]

### 3.3. [cite_start]The `Generate_Flight_Manifest` Function (Future) [cite: 121]

[cite_start]The next planned update is a function to generate a **complete manifest of all passengers inspected** for a specific incoming flight[cite: 121].

* [cite_start]**Lookup Method:** Utilizes the Flight uniqueness constraints (AirlineCode, FlightNumber, OriginAirportCode, FlightDate) to link to all associated **I\_94 records**[cite: 123].
* [cite_start]**Output:** A list of all passengers (Full Name), their Class of Admission, Admitted Status (Boolean), and Country of Citizenship[cite: 125].

---

## 4. Operational Scenarios

| Scenario | Traveler Status | Admission Class | Outcome Logic |
| :--- | :--- | :--- | :--- |
| [cite_start]**SCENARIO 1: Sarah Chen** [cite: 65] | [cite_start]Non-Immigrant Student (Taiwanese) [cite: 66, 67, 69] | [cite_start]**F1** (Academic Student) [cite: 71] | [cite_start]**Admitted (TRUE).** ExitDate (2028-06-30) is set for the program duration plus a grace period[cite: 72, 73]. [cite_start]ANumber is NULL[cite: 74]. |
| [cite_start]**SCENARIO 2: John Childs** [cite: 75] | [cite_start]Non-Immigrant Tourist (VWP/British) [cite: 76, 77] | **VWP** | [cite_start]**Denied (FALSE).** Assigned ANumber (**A203430239**) and mandatory removal ExitDate (2025-10-31)[cite: 84, 85]. [cite_start]NotAdmittedReason is logged (felony conviction)[cite: 80, 86]. |
| [cite_start]**SCENARIO 3: Joseph Henderson** [cite: 87] | U.S. Citizen | [cite_start]**C** (Citizen) [cite: 89] | [cite_start]**Admitted (TRUE).** Both **ANumber and ExitDate are set to NULL**, confirming permanent status rule[cite: 90]. |
| [cite_start]**SCENARIO 4: The Herrera Family** [cite: 91] | [cite_start]Newly Arriving Immigrants (Dominican Republic) [cite: 92] | **IR1 / IR2** | [cite_start]**Admitted (TRUE).** All three are linked to the **same FlightID**[cite: 94, 95]. [cite_start]Each is assigned a unique **ANumber** and has a **NULL ExitDate**[cite: 97, 98]. |

---

## [cite_start]5. CST-222 Project Scope (Frontend) [cite: 126]

[cite_start]This database will serve as the backend for the **CST-222 Computer Architecture and Assembly project**, which will be a Java console application[cite: 127]:

* [cite_start]**Connectivity:** Use the **JSch Dependency** to open an **SSH Tunnel** to the DB server, then use the **PostgreSQL Dependency** (JDBC) to connect[cite: 128, 129].
* [cite_start]**Officer Menu:** Create a console menu with a loop for the officer to utilize the three core SQL functions[cite: 130]:
    1.  [cite_start]**Admit New Traveler:** Call the `Admit_New_Traveler` function with manual input[cite: 131].
    2.  [cite_start]**Lookup I-94:** Call the `Lookup_I94_Record` function[cite: 132].
    3.  [cite_start]**Generate Flight Manifest:** Call the `Generate_Flight_Manifest` function[cite: 133].
